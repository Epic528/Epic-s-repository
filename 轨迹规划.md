#### 定义、 方式、与具体内容
---

#### 一、定义

指在满足机器人运动约束的前提下，为机器人生成一条**连续、可执行、带有时间信息**的运动轨迹，使其从初始状态（位置、姿态、速度等）移动到目标状态。

在机械臂中，我们将机器人末端执行器移动时的位姿随时间变化而得出的曲线称为其轨迹。我们之所以需要对机器人的轨迹进行规划是因为通常来说，我们对机器人的输入只有工具的起点和终点。而我们需要让机器人能够自然平滑的按照我们想要的方式从起点移动到终点，所以需要设计一个算法，使得机器人在移动的过程中，无论是位置的变化还是速度的变化都是连续且平滑的，有时，也会要求加速度的变化为连续的

---
#### 二、路径规划和轨迹规划的区别

**路径规划**

旨在在给定环境中为机器人寻找一条从起点到终点的**无碰撞、可行的几何路径**，需要考虑环境结构、障碍物分布及可达区域等因素。

常用方法包括基于[[几何插补的直线插补和圆弧插补、基于曲线表示的B样条与Bezier曲线，以及基于图搜索的A*  算法、Dijkstra算法]]等。此外，[[RRT（Rapidly-exploring Random Tree）和PRM（Probabilistic Roadmap）]]等随机采样算法也广泛应用于高维空间路径的全局规划。

**轨迹规划**

输出显式的时间参数化轨迹，如位置-时间曲线、速度-时间曲线和加速度-时间曲线。常见方法包括**多项式轨迹规划**（如3-4-5五次多项式）、梯形速度曲线（T型曲线）、S型速度曲线以及余弦速度曲线等。近年来，最小jerk和最小snap轨迹因具有更高的平滑性，在无人机和自动驾驶领域得到广泛应用。

---
#### 三、笛卡尔轨迹规划、关节空间轨迹规划

>在关节空间轨迹规划中，机械臂的末端位姿只在初始和终点处被明确指定。由于中间的运动轨迹无需精确控制，因此整个轨迹规划只需对起点和终点的关节角度进行两次逆运动学解算，分别对应起始位置和目标位置的关节角度。通过这种方式，**关节空间轨迹规划可以有效降低计算复杂度**，尤其在大规模的多关节机械臂系统中非常有优势。

>然而，关节空间轨迹规划也存在一些局限性。由于**不关注机械臂末端的实际轨迹**，可能会导致在实际运动中，机械臂末端经过不希望经过的区域，甚至可能产生干涉或碰撞的风险。因此，尽管关节空间轨迹规划的计算相对简单快速，但在一些需要精确控制末端执行器路径的任务中，使用这种方法可能存在不确定性

>相比之下，基于笛卡尔空间的轨迹规划更侧重于控制机械臂末端执行器的运动轨迹，在这种方法中，轨迹规划的对象是末端执行器在任务空间中的位置和姿态变化，即整个运动路径中的**每一个点的位移、速度和加速度**都需要进行精确的规划。为了实现这一点，机械臂的末端在轨迹中的每一个位置都必须进行逆运动学解算，以将其转化为对应的关节角度，从而驱动机械臂完成轨迹。

>在笛卡尔空问轨迹规划中，机械臂末端的运动路径得到高度关注，能够保证末端在空间中的每一个位置都按预期精确移动，这种方法特别适用于需要精确控制未端执行器路径的任务，例如焊接、喷涂或者装配等工业任务中，机器人必须精确地遵循预定的路径工作，

>由于每一个轨迹点都要进行逆运动学的实时解算，**笛卡尔空问轨迹规划的计算量比关节空间轨迹规划大得多**，因此这种方法对计算资源的要求更高，同时，由于需要确保整个运动过程的平滑性和无干涉，规划过程中器要考虑更多的约束条件，这种方法尽管计算复杂，但在对轨迹精度要求较高的任务中具有不可替代的优势，

***引用自  Xbotics-木木  [具身智能基础——机器人轨迹规划.docx](https://yv6uc1awtjc.feishu.cn/wiki/Zmk2we1JQiv9gBkyk0ZcMXgSnMd?from=from_copylink)***

---

#### 四、关节空间规划方法

以关节角的函数描述轨迹的轨迹生成办法

考虑一定时间内将工具从初始位置移动到目标位置，用逆运动学解出对应目标位姿的关节角，我们需要确定每个关节的运动函数，$t_0$ 时刻的值为关节的初始位置，$t_f$ 时刻的值为期望的目标位置，我们可以得出多种函数为关节角插值

##### 三次多项式

![[Pasted image 20251118162654.png]]

![[Pasted image 20251118162726.png]]

必须有三次多项式才能满足四个约束
$$
\theta(t)=a_0+a_1t+a_2t^2+a_3t^3

$$
所以
$$
\dot{\theta}=a_1+2a_2t+a_3t^2
$$$$
\ddot{\theta}=2a_2+6a_3t^2
$$
带入约束可解
![[Pasted image 20251118163345.png]]

若有中间点，则应用逆运动学方法求出中间点的关节角，再求平滑多项式
若末速度不为零，则
![[Pasted image 20251118163645.png]]

若每个中间点都有期望速度，用上式应用求解。


> [!NOTE]
> 确定中间点的期望速度有几种方法
> **1. 完全让用户输入所有中间节点的速度**
>     就是用户把每个中间点的速度手动指定。
> 	优点：很灵活，很精确。
> 	缺点：用户工作量大，用户很难知道某点该设多少速度才合理，如果算中点之间的直线段轨迹可能失真（叫“显著”或“跳跃”）
> 
> **2. 系统自动根据简单规则选择速度**
> 	系统自己给出一种**近似最小化折线斜率变化**的方法：
> 	1. 把所有中间点连成折线
> 	2. 计算每条线段的斜率（相当于“过渡速度”）
> 	3. 取每个中间点**前后两条线段斜率的平均值**作为该点的速度
> 这样做保证轨迹比较平滑，不至于出现突变。
> 
> **3.基于加速度连续性**
> 	假设各中间节点的加速度也要连续，
> ![[Pasted image 20251118164653.png]]
> 

##### 五阶多项式

![[Pasted image 20251118170357.png]]
![[Pasted image 20251118170411.png]]
![[Pasted image 20251118170425.png]]

抛物线、直线拟合：[(22 封私信) 机器人学导论---第七章 轨迹的生成（一）7.1-7.9 - 知乎](https://zhuanlan.zhihu.com/p/159018246)

---
#### 五、笛卡尔空间规划

笛卡尔空间规划是机器人轨迹规划中的一种基本方式，其核心思想是直接在**任务空间（也就是通常说的笛卡尔坐标系 x-y-z，以及可能包含姿态角度）中去描述与规划末端执行器的运动**。笛卡尔空间规划从“末端应该经过哪些位置”“运动路径是什么样”出发，然后再把这些期望的路径转换成关节角度，从而做到沿指定形状运动。

**典型流程**是：首先根据任务需求给出末端执行器在笛卡尔空间中的路径（可以是直线、圆弧，也可以是由一系列点组成的曲线），然后为这些路径上的离散点赋予合理的速度与加速度，使轨迹足够平滑。接着，将这些规划好的笛卡尔空间位置、速度和加速度通过逆运动学转换成关节角度、关节速度和关节加速度，最终形成能让机器人实际执行的控制指令。在整个过程中，笛卡尔空间的规划保证了末端按照期望路径运动，而逆运动学的转换保证了机器人真实关节动作的可实现性。


###### 其问题

**_1、不可达的中间点_**

（1）如图7-12，平面两杆机器人及其工作空间，连杆2臂连杆1短，所以工作空间的中间存在一个空洞，其半径为连杆长度之差。由起始点A到目标点B，关节空间中的路径容易实现，而笛卡尔空间中的直线路径将无法实现。

![](https://pic2.zhimg.com/v2-fc71326ee5caa26866cc0a6cc7290ee9_1440w.jpg)

**_2、再奇异点复紧的高关节速率_**

如图7-13，一个平面两杆（长度相同）操作臂，点A沿 路径运动到B点。期望轨迹是使操作臂末端以恒定的线速度作直线运动。可以看到，当机器人经过路径的中间部分时，关节1的速度非常高。一个解决方法使减小这个路径上的所有运动速度。

![](https://pic1.zhimg.com/v2-0304922fa7b962d55fa50ac82c8abbe8_1440w.jpg)

**_3、不同解下的可达起点和终点_**

图7-14，平面两杆操作臂两杆长度相等，但关节存在约束，使机器人到达空间给定的解的数量减少。尤其使当操作臂不能使用与起始点先沟通的解到达终点时，就会出现问题。

![](https://pic1.zhimg.com/v2-bc3c2b502e9556e98d2f366005e28cc8_1440w.jpg)

**_结论：一般默认使用关节空间路径。只有必要时，才使用笛卡尔空间的路径规划方法。_**

---
### Q&A：
#### 1、如果规定两秒钟必须完成一次动作，应该如何安排轨迹？

要在两秒钟内完成一次动作，首先需要将预定的空间路径表达为一个可以被时间驱动的函数。通常先把期望的笛卡尔空间路径用一个参数 $s\in[0,1]$ 表示，其中 $s=0$ 是起点，$s=1$是终点。接下来要做的是在给定总时间 $T=2\,\text{s}$的前提下设计一个时间标度 $s(t)$，使得路径能够在两秒内平滑走完，并且速度和加速度符合机器人运动学与动力学约束。

最常见的做法是使用平滑的时间标度函数，例如五次多项式时间缩放 $s(t)=10\tau^3-15\tau^4+6\tau^5$，其中 $\tau=t/T$。这种时间函数保证了在起点和终点处速度与加速度均为零，使轨迹非常平滑。路径的笛卡尔位置最终由 $p(t)=p(s(t))$给出，而末端速度与加速度可以通过链式法则由 $s(t)$ 的导数得到。

在路径由多个关键点组成的情况下，可以先计算各段的弧长，并按弧长比例把总时间分配到每一段，使得较长的段拥有更长的执行时间，避免速度过大。然后在每段内用三次多项式插值构造位置随时间的表达式，为每段设定起点和终点的速度，从而保证段与段之间的速度连续。中间节点的速度可以根据折线斜率平均、拐点置零，或根据加速度连续性求解获得。这样得到的轨迹既满足总时间限制，又在动力学上更容易执行。

最后，将笛卡尔轨迹通过逆运动学映射到关节空间，得到关节角、关节速度与关节加速度随时间的曲线。如果某些关节速度或加速度超出限制，可以通过重新分配时间或平滑时间标度来调整，直到轨迹完全可执行为止。

---
上一篇：[[Position，Orientation and Frames]]
下一篇：[[机器人运动学]]

